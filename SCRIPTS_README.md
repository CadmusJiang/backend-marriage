# 项目管理脚本

本项目提供了几个便捷的脚本来管理 marriage_system 服务。

## 脚本列表

### 1. run.sh - 统一管理脚本 ⭐
**功能**: 自动检查服务状态，如果运行中就停止，然后启动服务

**特性**:
- 自动检测服务运行状态
- 如果服务运行中，自动停止并清理
- 自动下载项目依赖
- 自动构建项目
- 启动服务
- 无需手动确认，全自动操作

**使用方法**:
```bash
./run.sh
```

### 2. start.sh - 启动脚本
**功能**: 检查端口占用情况并启动服务

**特性**:
- 检查端口 9999 是否被占用
- 验证项目依赖（Go、go.mod 文件）
- 自动下载项目依赖
- 构建项目
- 启动服务

**使用方法**:
```bash
./start.sh
```

### 2. stop.sh - 停止脚本
**功能**: 停止运行在端口 9999 上的服务

**特性**:
- 检查端口占用情况
- 优雅停止进程（先发送 TERM 信号）
- 强制停止顽固进程（发送 KILL 信号）
- 可选清理临时文件

**使用方法**:
```bash
./stop.sh
```

### 3. restart.sh - 重启脚本
**功能**: 停止服务并重新启动

**特性**:
- 先停止现有服务
- 等待端口释放
- 重新构建和启动服务

**使用方法**:
```bash
./restart.sh
```

### 4. status.sh - 状态检查脚本
**功能**: 检查服务运行状态

**特性**:
- 检查端口状态
- 检查服务健康状态（HTTP 响应）
- 检查日志文件
- 显示系统资源使用情况

**使用方法**:
```bash
./status.sh
```

## 快速开始

### 推荐使用（一键启动）
```bash
# 统一管理脚本 - 自动检查并启动
./run.sh
```

### 首次启动
```bash
# 启动服务
./start.sh
```

### 日常使用
```bash
# 一键启动/重启服务（推荐）
./run.sh

# 检查服务状态
./status.sh

# 重启服务
./restart.sh

# 停止服务
./stop.sh
```

## 服务信息

- **项目名称**: marriage_system
- **端口**: 9999
- **访问地址**: http://localhost:9999
- **API文档**: http://localhost:9999/docs/swagger.html
- **日志文件**: ./logs/marriage_system-access.log

## 故障排除

### 端口被占用
如果启动时提示端口被占用：
```bash
# 查看占用端口的进程
lsof -i :9999

# 停止占用端口的进程
./stop.sh
```

### 依赖问题
如果遇到依赖问题：
```bash
# 清理并重新下载依赖
go mod tidy
go mod download
```

### 权限问题
如果脚本无法执行：
```bash
# 添加执行权限
chmod +x *.sh
```

## 注意事项

1. 确保已安装 Go 1.16 或更高版本
2. 确保有足够的磁盘空间用于构建
3. 脚本会自动创建 logs 目录
4. 停止脚本会询问是否清理临时文件
5. 所有脚本都支持彩色输出，便于查看状态

## 环境要求

- macOS/Linux 系统
- Go 1.16+
- lsof 命令（用于端口检查）
- curl 命令（用于健康检查，可选）
