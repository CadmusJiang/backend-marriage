<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»Ÿä¸€æ—¥å¿—ç›‘æ§é¢æ¿</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #7f8c8d;
            font-size: 14px;
        }

        .nav-tabs {
            display: flex;
            background: #fff;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 0;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 500;
            color: #7f8c8d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav-tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .nav-tab:hover {
            color: #3498db;
        }

        .tab-content {
            background: #fff;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 20px;
            min-height: 600px;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        .refresh-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .refresh-btn:hover {
            background: #2980b9;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        .error {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 12px;
        }

        .log-entry {
            background: #fff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }

        .log-entry.http {
            border-left-color: #3498db;
        }

        .log-entry.mysql {
            border-left-color: #e74c3c;
        }

        .log-entry.redis {
            border-left-color: #f39c12;
        }

        .log-entry.system {
            border-left-color: #9b59b6;
        }
        
        .request-response-details {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #e9ecef;
        }
        
        .detail-section {
            margin-bottom: 15px;
        }
        
        .detail-item {
            margin-bottom: 8px;
            display: flex;
            align-items: flex-start;
        }
        
        .detail-label {
            font-weight: 500;
            color: #2c3e50;
            min-width: 80px;
            margin-right: 10px;
        }
        
        .detail-value {
            color: #34495e;
            word-break: break-all;
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ecf0f1;
        }

        .log-type {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
        }

        .log-type.http {
            background: #e8f4fd;
            color: #3498db;
        }

        .log-type.mysql {
            background: #fdf2f2;
            color: #e74c3c;
        }

        .log-type.redis {
            background: #fef9e7;
            color: #f39c12;
        }

        .log-type.system {
            background: #f4f1f8;
            color: #9b59b6;
        }

        .log-timestamp {
            font-size: 12px;
            color: #7f8c8d;
        }

        .log-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 10px;
        }

        .log-detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
        }

        .log-detail-label {
            font-weight: 500;
            color: #34495e;
            font-size: 12px;
        }

        .log-detail-value {
            color: #7f8c8d;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 11px;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .log-message {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            margin-bottom: 10px;
            word-break: break-all;
        }

        .sql-list, .redis-list {
            margin-top: 10px;
        }

        .sql-item, .redis-item {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 11px;
            margin-bottom: 5px;
            overflow-x: auto;
        }

        .sql-item {
            border-left: 3px solid #e74c3c;
        }

        .redis-item {
            border-left: 3px solid #f39c12;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }

        .empty-state .icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .filters {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .filter-row {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .filter-label {
            font-size: 12px;
            color: #7f8c8d;
            font-weight: 500;
        }

        .filter-select, .filter-input {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
        }

        .filter-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .filter-btn:hover {
            background: #229954;
        }

        .clear-btn {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .clear-btn:hover {
            background: #7f8c8d;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .page-btn {
            background: #fff;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .page-btn:hover {
            background: #f8f9fa;
        }

        .page-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .page-info {
            font-size: 12px;
            color: #7f8c8d;
        }

        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .auto-refresh-label {
            font-size: 12px;
            color: #7f8c8d;
        }

        .auto-refresh-select {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-success {
            background: #27ae60;
        }

        .status-error {
            background: #e74c3c;
        }

        .status-warning {
            background: #f39c12;
        }

        .status-info {
            background: #3498db;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tab {
                border-bottom: none;
                border-left: 3px solid transparent;
            }
            
            .nav-tab.active {
                border-left-color: #3498db;
                border-bottom-color: transparent;
            }
            
            .log-details {
                grid-template-columns: 1fr;
            }
            
            .filter-row {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ç»Ÿä¸€æ—¥å¿—ç›‘æ§é¢æ¿</h1>
            <div class="subtitle">å®æ—¶ç›‘æ§HTTPè¯·æ±‚ã€SQLæ“ä½œã€Redisæ“ä½œå’Œç³»ç»Ÿæ—¥å¿—</div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('unified')">ğŸ” ç»Ÿä¸€æ—¥å¿—</button>
            <button class="nav-tab" onclick="switchTab('http')">ğŸŒ HTTPè¯·æ±‚</button>
            <button class="nav-tab" onclick="switchTab('sql')">ğŸ—„ï¸ SQLæ“ä½œ</button>
            <button class="nav-tab" onclick="switchTab('redis')">ğŸ”´ Redisæ“ä½œ</button>
            <button class="nav-tab" onclick="switchTab('system')">âš™ï¸ ç³»ç»Ÿæ—¥å¿—</button>
        </div>

        <div class="tab-content">
            <!-- ç»Ÿä¸€æ—¥å¿—æ ‡ç­¾é¡µ -->
            <div id="unified-tab" class="tab-pane active">
                <div class="auto-refresh">
                    <span class="auto-refresh-label">è‡ªåŠ¨åˆ·æ–°:</span>
                    <select class="auto-refresh-select" onchange="setAutoRefresh(this.value)">
                        <option value="0">å…³é—­</option>
                        <option value="5">5ç§’</option>
                        <option value="10">10ç§’</option>
                        <option value="30" selected>30ç§’</option>
                        <option value="60">1åˆ†é’Ÿ</option>
                    </select>
                </div>

                <div class="filters">
                    <div class="filter-row">
                        <div class="filter-group">
                            <span class="filter-label">æ—¥å¿—ç±»å‹:</span>
                            <select class="filter-select" id="typeFilter">
                                <option value="">å…¨éƒ¨</option>
                                <option value="http">HTTPè¯·æ±‚</option>
                                <option value="mysql">SQLæ“ä½œ</option>
                                <option value="redis">Redisæ“ä½œ</option>
                                <option value="system">ç³»ç»Ÿæ—¥å¿—</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">çŠ¶æ€:</span>
                            <select class="filter-select" id="statusFilter">
                                <option value="">å…¨éƒ¨</option>
                                <option value="success">æˆåŠŸ</option>
                                <option value="error">é”™è¯¯</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">æœç´¢:</span>
                            <input type="text" class="filter-input" id="searchFilter" placeholder="æœç´¢æ—¥å¿—å†…å®¹...">
                        </div>
                        <button class="filter-btn" onclick="applyFilters()">åº”ç”¨è¿‡æ»¤</button>
                        <button class="clear-btn" onclick="clearFilters()">æ¸…é™¤è¿‡æ»¤</button>
                    </div>
                </div>

                <button class="refresh-btn" onclick="loadUnifiedLogs()">ğŸ”„ åˆ·æ–°æ—¥å¿—</button>
                <div id="unified-loading" class="loading">æ­£åœ¨åŠ è½½ç»Ÿä¸€æ—¥å¿—ä¿¡æ¯...</div>
                <div id="unified-error" class="error" style="display: none;"></div>
                <div id="unified-content" style="display: none;">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="total-logs">0</div>
                            <div class="stat-label">æ€»æ—¥å¿—æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="http-logs">0</div>
                            <div class="stat-label">HTTPè¯·æ±‚</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="sql-logs">0</div>
                            <div class="stat-label">SQLæ“ä½œ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="redis-logs">0</div>
                            <div class="stat-label">Redisæ“ä½œ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="system-logs">0</div>
                            <div class="stat-label">ç³»ç»Ÿæ—¥å¿—</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="with-sql">0</div>
                            <div class="stat-label">åŒ…å«SQL</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="with-redis">0</div>
                            <div class="stat-label">åŒ…å«Redis</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="last-update">-</div>
                            <div class="stat-label">æœ€åæ›´æ–°</div>
                        </div>
                    </div>
                    <div id="unified-logs-list"></div>
                    <div class="pagination">
                        <button class="page-btn" onclick="changePage(-1)">ä¸Šä¸€é¡µ</button>
                        <span class="page-info" id="page-info">ç¬¬ 1 é¡µï¼Œå…± 1 é¡µ</span>
                        <button class="page-btn" onclick="changePage(1)">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
            </div>

            <!-- HTTPè¯·æ±‚æ ‡ç­¾é¡µ -->
            <div id="http-tab" class="tab-pane">
                <button class="refresh-btn" onclick="loadHttpLogs()">ğŸ”„ åˆ·æ–°HTTPæ—¥å¿—</button>
                <div id="http-loading" class="loading">æ­£åœ¨åŠ è½½HTTPè¯·æ±‚æ—¥å¿—...</div>
                <div id="http-error" class="error" style="display: none;"></div>
                <div id="http-content" style="display: none;">
                    <div id="http-logs-list"></div>
                </div>
            </div>

            <!-- SQLæ“ä½œæ ‡ç­¾é¡µ -->
            <div id="sql-tab" class="tab-pane">
                <button class="refresh-btn" onclick="loadSqlLogs()">ğŸ”„ åˆ·æ–°SQLæ—¥å¿—</button>
                <div id="sql-loading" class="loading">æ­£åœ¨åŠ è½½SQLæ“ä½œæ—¥å¿—...</div>
                <div id="sql-error" class="error" style="display: none;"></div>
                <div id="sql-content" style="display: none;">
                    <div id="sql-logs-list"></div>
                </div>
            </div>

            <!-- Redisæ“ä½œæ ‡ç­¾é¡µ -->
            <div id="redis-tab" class="tab-pane">
                <button class="refresh-btn" onclick="loadRedisLogs()">ğŸ”„ åˆ·æ–°Redisæ—¥å¿—</button>
                <div id="redis-loading" class="loading">æ­£åœ¨åŠ è½½Redisæ“ä½œæ—¥å¿—...</div>
                <div id="redis-error" class="error" style="display: none;"></div>
                <div id="redis-content" style="display: none;">
                    <div id="redis-logs-list"></div>
                </div>
            </div>

            <!-- ç³»ç»Ÿæ—¥å¿—æ ‡ç­¾é¡µ -->
            <div id="system-tab" class="tab-pane">
                <button class="refresh-btn" onclick="loadSystemLogs()">ğŸ”„ åˆ·æ–°ç³»ç»Ÿæ—¥å¿—</button>
                <div id="system-loading" class="loading">æ­£åœ¨åŠ è½½ç³»ç»Ÿæ—¥å¿—...</div>
                <div id="system-error" class="error" style="display: none;"></div>
                <div id="system-content" style="display: none;">
                    <div id="system-logs-list"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'unified';
        let currentPage = 1;
        let pageSize = 20;
        let logs = []; // Changed from allLogs to logs
        let filteredLogs = [];
        let autoRefreshInterval = null;

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            loadUnifiedLogs();
            setAutoRefresh('30');
        });

        function switchTab(tabName) {
            // æ›´æ–°æ ‡ç­¾é¡µçŠ¶æ€
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });

            // æ‰¾åˆ°å¯¹åº”çš„tabæŒ‰é’®å¹¶æ¿€æ´»
            const tabButton = document.querySelector(`[onclick="switchTab('${tabName}')"]`);
            if (tabButton) {
                tabButton.classList.add('active');
            }
            
            // æ¿€æ´»å¯¹åº”çš„å†…å®¹é¢æ¿
            const tabPane = document.getElementById(`${tabName}-tab`);
            if (tabPane) {
                tabPane.classList.add('active');
            }

            currentTab = tabName;

            // åŠ è½½å¯¹åº”æ•°æ®
            switch(tabName) {
                case 'unified':
                    loadUnifiedLogs();
                    break;
                case 'http':
                    loadHttpLogs();
                    break;
                case 'sql':
                    loadSqlLogs();
                    break;
                case 'redis':
                    loadRedisLogs();
                    break;
                case 'system':
                    loadSystemLogs();
                    break;
            }
        }

        function setAutoRefresh(interval) {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
            
            if (interval > 0) {
                autoRefreshInterval = setInterval(() => {
                    switch(currentTab) {
                        case 'unified':
                            loadUnifiedLogs();
                            break;
                        case 'http':
                            loadHttpLogs();
                            break;
                        case 'sql':
                            loadSqlLogs();
                            break;
                        case 'redis':
                            loadRedisLogs();
                            break;
                        case 'system':
                            loadSystemLogs();
                            break;
                    }
                }, interval * 1000);
            }
        }

        function loadUnifiedLogs() {
            const loading = document.getElementById('unified-loading');
            const error = document.getElementById('unified-error');
            const content = document.getElementById('unified-content');

            loading.style.display = 'block';
            error.style.display = 'none';
            content.style.display = 'none';

            // ç»Ÿä¸€æ—¥å¿—æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—å†…å®¹
            fetch('/system/logs/unified')
                .then(response => response.json())
                .then(data => {
                    loading.style.display = 'none';
                    content.style.display = 'block';
                    
                    if (data.success === false) {
                        throw new Error(data.message || 'åŠ è½½å¤±è´¥');
                    }
                    
                    // ç»Ÿä¸€æ—¥å¿—æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—ï¼Œä¸è¿›è¡Œè¿‡æ»¤
                    const allLogs = data.data ? data.data.logs || [] : [];
                    logs = allLogs;
                    filteredLogs = [...logs];
                    applyCurrentFilters();
                    renderLogsList();
                })
                .catch(err => {
                    loading.style.display = 'none';
                    error.style.display = 'block';
                    error.textContent = 'åŠ è½½ç»Ÿä¸€æ—¥å¿—å¤±è´¥: ' + err.message;
                });
        }

        function renderUnifiedLogs(data) {
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            if (data.data && data.data.stats) {
                document.getElementById('total-logs').textContent = data.data.stats.total || 0;
                document.getElementById('http-logs').textContent = data.data.stats.http || 0;
                document.getElementById('sql-logs').textContent = data.data.stats.mysql || 0;
                document.getElementById('redis-logs').textContent = data.data.stats.redis || 0;
                document.getElementById('system-logs').textContent = data.data.stats.system || 0;
                document.getElementById('with-sql').textContent = data.data.stats.with_sql || 0;
                document.getElementById('with-redis').textContent = data.data.stats.with_redis || 0;
            }
            
            document.getElementById('last-update').textContent = data.data ? data.data.timestamp : '-';

            // å­˜å‚¨æ‰€æœ‰æ—¥å¿—
            logs = data.data ? data.data.logs || [] : []; // Changed from allLogs to logs
            filteredLogs = [...logs];
            
            // åº”ç”¨å½“å‰è¿‡æ»¤æ¡ä»¶
            applyCurrentFilters();
            
            // æ¸²æŸ“æ—¥å¿—åˆ—è¡¨
            renderLogsList();
        }

        function applyFilters() {
            applyCurrentFilters();
            renderLogsList();
        }

        function applyCurrentFilters() {
            const typeFilter = document.getElementById('typeFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const searchFilter = document.getElementById('searchFilter').value.toLowerCase();

            filteredLogs = logs.filter(log => { // Changed from allLogs to logs
                // ç±»å‹è¿‡æ»¤
                if (typeFilter && !log.type.includes(typeFilter)) {
                    return false;
                }

                // çŠ¶æ€è¿‡æ»¤
                if (statusFilter) {
                    if (statusFilter === 'success' && !log.success) {
                        return false;
                    }
                    if (statusFilter === 'error' && log.success !== false) {
                        return false;
                    }
                }

                // æœç´¢è¿‡æ»¤
                if (searchFilter) {
                    const searchText = [
                        log.message || '',
                        log.path || '',
                        log.method || '',
                        log.traceId || '',
                        log.error || ''
                    ].join(' ').toLowerCase();
                    
                    if (!searchText.includes(searchFilter)) {
                        return false;
                    }
                }

                return true;
            });

            currentPage = 1;
        }

        function clearFilters() {
            document.getElementById('typeFilter').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('searchFilter').value = '';
            applyCurrentFilters();
            renderLogsList();
        }

        function changePage(delta) {
            const totalPages = Math.ceil(filteredLogs.length / pageSize);
            const newPage = currentPage + delta;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderLogsList();
            }
        }

        function renderLogsList() {
            const container = document.getElementById('unified-logs-list');
            
            if (filteredLogs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ğŸ“</div>
                        <div>æš‚æ— æ—¥å¿—è®°å½•</div>
                        <div style="font-size: 12px; margin-top: 10px;">è¯·æ£€æŸ¥è¿‡æ»¤æ¡ä»¶æˆ–ç¨åå†è¯•</div>
                    </div>
                `;
                document.getElementById('page-info').textContent = 'ç¬¬ 1 é¡µï¼Œå…± 1 é¡µ';
                return;
            }

            const totalPages = Math.ceil(filteredLogs.length / pageSize);
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, filteredLogs.length);
            const pageLogs = filteredLogs.slice(startIndex, endIndex);

            let logsHtml = '';
            pageLogs.forEach((log, index) => {
                const statusClass = log.success ? 'status-success' : 'status-error';
                const statusText = log.success ? 'æˆåŠŸ' : 'å¤±è´¥';
                
                logsHtml += `
                    <div class="log-entry ${log.type}">
                        <div class="log-header">
                            <div>
                                <span class="log-type ${log.type}">${getLogTypeText(log.type)}</span>
                                <span class="status-indicator ${statusClass}"></span>
                                <span style="font-size: 12px; color: #7f8c8d;">${statusText}</span>
                            </div>
                            <div class="log-timestamp">${log.timestamp}</div>
                        </div>
                        
                        <div class="log-details">
                            ${log.traceId ? `<div class="log-detail-item">
                                <span class="log-detail-label">Trace ID:</span>
                                <span class="log-detail-value">${log.traceId}</span>
                            </div>` : ''}
                            ${log.method ? `<div class="log-detail-item">
                                <span class="log-detail-label">æ–¹æ³•:</span>
                                <span class="log-detail-value">${log.method}</span>
                            </div>` : ''}
                            ${log.path ? `<div class="log-detail-item">
                                <span class="log-detail-label">è·¯å¾„:</span>
                                <span class="log-detail-value">${log.path}</span>
                            </div>` : ''}
                            ${log.statusCode ? `<div class="log-detail-item">
                                <span class="log-detail-label">çŠ¶æ€ç :</span>
                                <span class="log-detail-value">${log.statusCode}</span>
                            </div>` : ''}
                            ${log.duration ? `<div class="log-detail-item">
                                <span class="log-detail-label">è€—æ—¶:</span>
                                <span class="log-detail-value">${log.duration.toFixed(3)}s</span>
                            </div>` : ''}
                        </div>
                        
                        ${log.message ? `<div class="log-message">${log.message}</div>` : ''}
                        
                        ${log.error ? `<div class="log-message" style="background: #fdf2f2; color: #e74c3c;">é”™è¯¯: ${log.error}</div>` : ''}
                        
                        ${renderHttpDetails(log)}
                        
                        ${log.sqls && log.sqls.length > 0 ? `
                            <div class="sql-list" style="margin-top: 10px; padding: 12px; background: #fef7f7; border-radius: 6px; border: 1px solid #fadbd8;">
                                <div style="font-weight: 600; margin-bottom: 10px; color: #e74c3c; font-size: 14px;">ğŸ—„ï¸ SQLæ“ä½œ (${log.sqls.length})</div>
                                ${log.sqls.map((sql, index) => `
                                    <div class="sql-item" style="margin-bottom: 12px; padding: 10px; background: #2c3e50; border-radius: 4px; border: 1px solid #e74c3c; color: #ecf0f1;">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #ecf0f1; font-size: 12px;">SQL #${index + 1}:</div>
                                        <div style="margin-bottom: 8px; font-family: 'Courier New', monospace; font-size: 12px; background: #34495e; padding: 8px; border-radius: 3px; border-left: 3px solid #e74c3c; line-height: 1.4; color: #ecf0f1;">
                                            ${sql.sql || 'N/A'}
                                        </div>
                                        <div style="display: flex; gap: 20px; font-size: 11px; color: #bdc3c7;">
                                            <span>â±ï¸ è€—æ—¶: ${(sql.cost_seconds || 0).toFixed(3)}s</span>
                                            <span>ğŸ“Š å½±å“è¡Œæ•°: ${sql.rows_affected || 0}</span>
                                            <span>ğŸ“ ä½ç½®: ${sql.stack || 'N/A'}</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                        
                        ${log.redisOps && log.redisOps.length > 0 ? `
                            <div class="redis-list" style="margin-top: 10px; padding: 12px; background: #fef9e7; border-radius: 6px; border: 1px solid #f8d7da;">
                                <div style="font-weight: 600; margin-bottom: 10px; color: #f39c12; font-size: 14px;">ğŸ”´ Redisæ“ä½œ (${log.redisOps.length})</div>
                                ${log.redisOps.map((redis, index) => `
                                    <div class="redis-item" style="margin-bottom: 12px; padding: 10px; background: #2c3e50; border-radius: 4px; border: 1px solid #f39c12; color: #ecf0f1;">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #ecf0f1; font-size: 12px;">Redis #${index + 1}:</div>
                                        <div style="margin-bottom: 8px; font-family: 'Courier New', monospace; font-size: 12px; background: #34495e; padding: 8px; border-radius: 3px; border-left: 3px solid #f39c12; line-height: 1.4; color: #ecf0f1;">
                                            ${redis.handle || 'N/A'}
                                        </div>
                                        <div style="display: flex; gap: 20px; font-size: 11px; color: #bdc3c7;">
                                            <span>â±ï¸ è€—æ—¶: ${(redis.cost_seconds || 0).toFixed(3)}s</span>
                                            <span>ğŸ”‘ Key: ${redis.key || 'N/A'}</span>
                                            ${redis.value ? `<span>ğŸ’¾ Value: ${redis.value}</span>` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            container.innerHTML = logsHtml;
            document.getElementById('page-info').textContent = `ç¬¬ ${currentPage} é¡µï¼Œå…± ${totalPages} é¡µ`;
        }

        function getLogTypeText(type) {
            switch(type) {
                case 'http':
                    return 'HTTP';
                case 'http_with_sql':
                    return 'HTTP+SQL';
                case 'http_with_redis':
                    return 'HTTP+Redis';
                case 'http_with_sql_redis':
                    return 'HTTP+SQL+Redis';
                case 'mysql':
                    return 'SQL';
                case 'redis':
                    return 'Redis';
                case 'system':
                    return 'System';
                default:
                    return type;
            }
        }

        function loadHttpLogs() {
            const loading = document.getElementById('http-loading');
            const error = document.getElementById('http-error');
            const content = document.getElementById('http-content');

            loading.style.display = 'block';
            error.style.display = 'none';
            content.style.display = 'none';

            // HTTPè¯·æ±‚tabåªæ˜¾ç¤ºHTTPç›¸å…³çš„æ—¥å¿—
            fetch('/system/logs/unified')
                .then(response => response.json())
                .then(data => {
                    loading.style.display = 'none';
                    content.style.display = 'block';
                    
                    if (data.success === false) {
                        throw new Error(data.message || 'åŠ è½½å¤±è´¥');
                    }
                    
                    // è¿‡æ»¤å‡ºHTTPç›¸å…³çš„æ—¥å¿—ï¼ŒåŒ…æ‹¬åŒ…å«HTTPä¿¡æ¯çš„æ—¥å¿—
                    const httpLogs = (data.data ? data.data.logs || [] : []).filter(log => {
                        // æ£€æŸ¥æ˜¯å¦æ˜¯HTTPç±»å‹çš„æ—¥å¿—
                        if (log.type && (log.type.includes('http') || log.method || log.path)) {
                            return true;
                        }
                        // æ£€æŸ¥æ˜¯å¦åŒ…å«HTTPç›¸å…³ä¿¡æ¯
                        if (log.details && log.details.åŸå§‹æ•°æ® && log.details.åŸå§‹æ•°æ®.trace_info) {
                            return true;
                        }
                        return false;
                    });
                    
                    console.log('HTTPæ—¥å¿—è¿‡æ»¤ç»“æœ:', httpLogs); // è°ƒè¯•ä¿¡æ¯
                    renderFilteredLogs(httpLogs, 'http-logs-list');
                })
                .catch(err => {
                    loading.style.display = 'none';
                    error.style.display = 'block';
                    error.textContent = 'åŠ è½½HTTPæ—¥å¿—å¤±è´¥: ' + err.message;
                });
        }

        function loadSqlLogs() {
            const loading = document.getElementById('sql-loading');
            const error = document.getElementById('sql-error');
            const content = document.getElementById('sql-content');

            loading.style.display = 'block';
            error.style.display = 'none';
            content.style.display = 'none';

            // SQLæ“ä½œtabåªæ˜¾ç¤ºSQLç›¸å…³çš„æ—¥å¿—
            fetch('/system/logs/unified')
                .then(response => response.json())
                .then(data => {
                    loading.style.display = 'none';
                    content.style.display = 'block';
                    
                    if (data.success === false) {
                        throw new Error(data.message || 'åŠ è½½å¤±è´¥');
                    }
                    
                    // åªè¿‡æ»¤å‡ºSQLç›¸å…³çš„æ—¥å¿—
                    const sqlLogs = (data.data ? data.data.logs || [] : []).filter(log => 
                        log.type === 'mysql' || log.type === 'http_with_sql' || log.type === 'http_with_sql_redis' || log.sqlCount > 0
                    );
                    
                    renderSqlLogs(sqlLogs);
                })
                .catch(err => {
                    loading.style.display = 'none';
                    error.style.display = 'block';
                    error.textContent = 'åŠ è½½SQLæ—¥å¿—å¤±è´¥: ' + err.message;
                });
        }

        function loadRedisLogs() {
            const loading = document.getElementById('redis-loading');
            const error = document.getElementById('redis-error');
            const content = document.getElementById('redis-content');

            loading.style.display = 'block';
            error.style.display = 'none';
            content.style.display = 'none';

            // Redisæ“ä½œtabåªæ˜¾ç¤ºRedisç›¸å…³çš„æ—¥å¿—
            fetch('/system/logs/unified')
                .then(response => response.json())
                .then(data => {
                    loading.style.display = 'none';
                    content.style.display = 'block';
                    
                    if (data.success === false) {
                        throw new Error(data.message || 'åŠ è½½å¤±è´¥');
                    }
                    
                    // åªè¿‡æ»¤å‡ºRedisç›¸å…³çš„æ—¥å¿—
                    const redisLogs = (data.data ? data.data.logs || [] : []).filter(log => 
                        log.type === 'redis' || log.type === 'http_with_redis' || log.type === 'http_with_sql_redis' || log.redisCount > 0
                    );
                    
                    renderRedisLogs(redisLogs);
                })
                .catch(err => {
                    loading.style.display = 'none';
                    error.style.display = 'block';
                    error.textContent = 'åŠ è½½Redisæ—¥å¿—å¤±è´¥: ' + err.message;
                });
        }

        function loadSystemLogs() {
            const loading = document.getElementById('system-loading');
            const error = document.getElementById('system-error');
            const content = document.getElementById('system-content');

            loading.style.display = 'block';
            error.style.display = 'none';
            content.style.display = 'none';

            // ç³»ç»Ÿæ—¥å¿—tabåªæ˜¾ç¤ºç³»ç»Ÿç›¸å…³çš„æ—¥å¿—
            fetch('/system/logs/unified')
                .then(response => response.json())
                .then(data => {
                    loading.style.display = 'none';
                    content.style.display = 'block';
                    
                    if (data.success === false) {
                        throw new Error(data.message || 'åŠ è½½å¤±è´¥');
                    }
                    
                    // åªè¿‡æ»¤å‡ºç³»ç»Ÿç›¸å…³çš„æ—¥å¿—
                    const systemLogs = (data.data ? data.data.logs || [] : []).filter(log => 
                        log.type === 'system'
                    );
                    
                    renderFilteredLogs(systemLogs, 'system-logs-list');
                })
                .catch(err => {
                    loading.style.display = 'none';
                    error.style.display = 'block';
                    error.textContent = 'åŠ è½½ç³»ç»Ÿæ—¥å¿—å¤±è´¥: ' + err.message;
                });
        }

        function renderFilteredLogs(logs, containerId) {
            const container = document.getElementById(containerId);
            
            if (logs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ğŸ“</div>
                        <div>æš‚æ— ç›¸å…³æ—¥å¿—è®°å½•</div>
                        <div style="font-size: 12px; margin-top: 10px;">è¯·ç¨åå†è¯•æˆ–åˆ‡æ¢åˆ°å…¶ä»–æ ‡ç­¾é¡µ</div>
                    </div>
                `;
                return;
            }

            console.log('æ¸²æŸ“æ—¥å¿—:', logs); // è°ƒè¯•ä¿¡æ¯

            let logsHtml = '';
            logs.forEach(log => {
                const statusClass = log.success ? 'status-success' : 'status-error';
                const statusText = log.success ? 'æˆåŠŸ' : 'å¤±è´¥';
                
                logsHtml += `
                    <div class="log-entry ${log.type}">
                        <div class="log-header">
                            <div>
                                <span class="log-type ${log.type}">${getLogTypeText(log.type)}</span>
                                <span class="status-indicator ${statusClass}"></span>
                                <span style="font-size: 12px; color: #7f8c8d;">${statusText}</span>
                            </div>
                            <div class="log-timestamp">${log.timestamp}</div>
                        </div>
                        
                        <div class="log-details">
                            ${log.traceId ? `<div class="log-detail-item">
                                <span class="log-detail-label">Trace ID:</span>
                                <span class="log-detail-value">${log.traceId}</span>
                            </div>` : ''}
                            ${log.method ? `<div class="log-detail-item">
                                <span class="log-detail-label">æ–¹æ³•:</span>
                                <span class="log-detail-value">${log.method}</span>
                            </div>` : ''}
                            ${log.path ? `<div class="log-detail-item">
                                <span class="log-detail-label">è·¯å¾„:</span>
                                <span class="log-detail-value">${log.path}</span>
                            </div>` : ''}
                            ${log.statusCode ? `<div class="log-detail-item">
                                <span class="log-detail-label">çŠ¶æ€ç :</span>
                                <span class="log-detail-value">${log.statusCode}</span>
                            </div>` : ''}
                            ${log.duration ? `<div class="log-detail-item">
                                <span class="log-detail-label">è€—æ—¶:</span>
                                <span class="log-detail-value">${log.duration.toFixed(3)}s</span>
                            </div>` : ''}
                        </div>
                        
                        ${log.message ? `<div class="log-message">${log.message}</div>` : ''}
                        
                        ${log.error ? `<div class="log-message" style="background: #fdf2f2; color: #e74c3c;">é”™è¯¯: ${log.error}</div>` : ''}
                        
                        ${renderHttpDetails(log)}
                        
                        ${containerId === 'http-logs-list' ? '' : `
                            ${log.sqls && log.sqls.length > 0 ? `
                                <div class="sql-list" style="margin-top: 10px; padding: 12px; background: #fef7f7; border-radius: 6px; border: 1px solid #fadbd8;">
                                    <div style="font-weight: 600; margin-bottom: 10px; color: #e74c3c; font-size: 14px;">ğŸ—„ï¸ SQLæ“ä½œ (${log.sqls.length})</div>
                                    ${log.sqls.map((sql, index) => `
                                        <div class="sql-item" style="margin-bottom: 12px; padding: 10px; background: #2c3e50; border-radius: 4px; border: 1px solid #e74c3c; color: #ecf0f1;">
                                            <div style="font-weight: 600; margin-bottom: 8px; color: #ecf0f1; font-size: 12px;">SQL #${index + 1}:</div>
                                            <div style="margin-bottom: 8px; font-family: 'Courier New', monospace; font-size: 12px; background: #34495e; padding: 8px; border-radius: 3px; border-left: 3px solid #e74c3c; line-height: 1.4; color: #ecf0f1;">
                                                ${sql.sql || 'N/A'}
                                            </div>
                                            <div style="display: flex; gap: 20px; font-size: 11px; color: #bdc3c7;">
                                                <span>â±ï¸ è€—æ—¶: ${(sql.cost_seconds || 0).toFixed(3)}s</span>
                                                <span>ğŸ“Š å½±å“è¡Œæ•°: ${sql.rows_affected || 0}</span>
                                                <span>ğŸ“ ä½ç½®: ${sql.stack || 'N/A'}</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                            
                            ${log.redisOps && log.redisOps.length > 0 ? `
                                <div class="redis-list" style="margin-top: 10px; padding: 12px; background: #fef9e7; border-radius: 6px; border: 1px solid #f8d7da;">
                                    <div style="font-weight: 600; margin-bottom: 10px; color: #f39c12; font-size: 14px;">ğŸ”´ Redisæ“ä½œ (${log.redisOps.length})</div>
                                    ${log.redisOps.map((redis, index) => `
                                        <div class="redis-item" style="margin-bottom: 12px; padding: 10px; background: #2c3e50; border-radius: 4px; border: 1px solid #f39c12; color: #ecf0f1;">
                                            <div style="font-weight: 600; margin-bottom: 8px; color: #ecf0f1; font-size: 12px;">Redis #${index + 1}:</div>
                                            <div style="margin-bottom: 8px; font-family: 'Courier New', monospace; font-size: 12px; background: #34495e; padding: 8px; border-radius: 3px; border-left: 3px solid #f39c12; line-height: 1.4; color: #ecf0f1;">
                                                ${redis.handle || 'N/A'}
                                            </div>
                                            <div style="display: flex; gap: 20px; font-size: 11px; color: #bdc3c7;">
                                                <span>â±ï¸ è€—æ—¶: ${(redis.cost_seconds || 0).toFixed(3)}s</span>
                                                <span>ğŸ”‘ Key: ${redis.key || 'N/A'}</span>
                                                ${redis.value ? `<span>ğŸ’¾ Value: ${redis.value}</span>` : ''}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        `}
                    </div>
                `;
            });

            container.innerHTML = logsHtml;
        }

        // æ–°å¢å‡½æ•°ï¼šæ¸²æŸ“HTTPè¯¦ç»†å†…å®¹
        function renderHttpDetails(log) {
            // æ£€æŸ¥æ˜¯å¦æœ‰trace_infoæ•°æ®
            if (log.details && log.details.åŸå§‹æ•°æ® && log.details.åŸå§‹æ•°æ®.trace_info) {
                const traceInfo = log.details.åŸå§‹æ•°æ®.trace_info;
                let detailsHtml = `
                    <div class="request-response-details" style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px;">
                        <div style="font-weight: 500; margin-bottom: 10px; color: #3498db;">ğŸ” è¯·æ±‚è¯¦æƒ…:</div>
                `;

                // è¯·æ±‚ä¿¡æ¯
                if (traceInfo.request) {
                    detailsHtml += `
                        <div class="detail-section" style="margin-bottom: 15px;">
                            <div style="font-weight: 500; margin-bottom: 5px; color: #2c3e50;">ğŸ“¤ è¯·æ±‚ä¿¡æ¯:</div>
                            <div class="detail-item">
                                <span class="detail-label">æ–¹æ³•:</span>
                                <span class="detail-value">${traceInfo.request.method || 'N/A'}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">URL:</span>
                                <span class="detail-value">${traceInfo.request.decoded_url || 'N/A'}</span>
                            </div>
                            ${traceInfo.request.header ? `
                                <div class="detail-item">
                                    <span class="detail-label">è¯·æ±‚å¤´:</span>
                                    <div class="detail-value" style="background: #fff; padding: 10px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px; white-space: pre-wrap; border: 1px solid #ddd; line-height: 1.5; color: #333; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
                                        ${JSON.stringify(traceInfo.request.header, null, 2)}
                                    </div>
                                </div>
                            ` : ''}
                            ${traceInfo.request.body ? `
                                <div class="detail-item">
                                    <span class="detail-label">è¯·æ±‚ä½“:</span>
                                    <div class="detail-value" style="background: #fff; padding: 10px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px; white-space: pre-wrap; border: 1px solid #ddd; line-height: 1.5; color: #333; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
                                        ${traceInfo.request.body}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                }

                // å“åº”ä¿¡æ¯
                if (traceInfo.response) {
                    detailsHtml += `
                        <div class="detail-section" style="margin-bottom: 15px;">
                            <div style="font-weight: 500; margin-bottom: 5px; color: #2c3e50;">ğŸ“¥ å“åº”ä¿¡æ¯:</div>
                            <div class="detail-item">
                                <span class="detail-label">çŠ¶æ€ç :</span>
                                <span class="detail-value">${traceInfo.response.http_code || 'N/A'}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">çŠ¶æ€æ¶ˆæ¯:</span>
                                <span class="detail-value">${traceInfo.response.http_code_msg || 'N/A'}</span>
                            </div>
                            ${traceInfo.response.header ? `
                                <div class="detail-item">
                                    <span class="detail-label">å“åº”å¤´:</span>
                                    <div class="detail-value" style="background: #fff; padding: 10px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px; white-space: pre-wrap; border: 1px solid #ddd; line-height: 1.5; color: #333; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
                                        ${JSON.stringify(traceInfo.response.header, null, 2)}
                                    </div>
                                </div>
                            ` : ''}
                            ${traceInfo.response.body ? `
                                <div class="detail-item">
                                    <span class="detail-label">å“åº”ä½“:</span>
                                    <div class="detail-value" style="background: #fff; padding: 10px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px; white-space: pre-wrap; border: 1px solid #ddd; line-height: 1.5; color: #333; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
                                        ${JSON.stringify(traceInfo.response.body, null, 2)}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                }

                detailsHtml += '</div>';
                return detailsHtml;
            }

            return '';
        }

        // æ–°å¢å‡½æ•°ï¼šæ¸²æŸ“SQLæ—¥å¿—ï¼ˆåªæ˜¾ç¤ºSQLç›¸å…³å†…å®¹ï¼‰
        function renderSqlLogs(logs) {
            const container = document.getElementById('sql-logs-list');
            
            if (logs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ğŸ—„ï¸</div>
                        <div>æš‚æ— SQLæ“ä½œæ—¥å¿—</div>
                        <div style="font-size: 12px; margin-top: 10px;">è¯·ç¨åå†è¯•æˆ–åˆ‡æ¢åˆ°å…¶ä»–æ ‡ç­¾é¡µ</div>
                    </div>
                `;
                return;
            }

            let logsHtml = '';
            logs.forEach(log => {
                const statusClass = log.success ? 'status-success' : 'status-error';
                const statusText = log.success ? 'æˆåŠŸ' : 'å¤±è´¥';
                
                logsHtml += `
                    <div class="log-entry ${log.type}">
                        <div class="log-header">
                            <div>
                                <span class="log-type ${log.type}">${getLogTypeText(log.type)}</span>
                                <span class="status-indicator ${statusClass}"></span>
                                <span style="font-size: 12px; color: #7f8c8d;">${statusText}</span>
                            </div>
                            <div class="log-timestamp">${log.timestamp}</div>
                        </div>
                        
                        <div class="log-details">
                            ${log.traceId ? `<div class="log-detail-item">
                                <span class="log-detail-label">Trace ID:</span>
                                <span class="log-detail-value">${log.traceId}</span>
                            </div>` : ''}
                            ${log.method ? `<div class="log-detail-item">
                                <span class="log-detail-label">æ–¹æ³•:</span>
                                <span class="log-detail-value">${log.method}</span>
                            </div>` : ''}
                            ${log.path ? `<div class="log-detail-item">
                                <span class="log-detail-label">è·¯å¾„:</span>
                                <span class="log-detail-value">${log.path}</span>
                            </div>` : ''}
                            ${log.duration ? `<div class="log-detail-item">
                                <span class="log-detail-label">æ€»è€—æ—¶:</span>
                                <span class="log-detail-value">${log.duration.toFixed(3)}s</span>
                            </div>` : ''}
                        </div>
                        
                        ${log.message ? `<div class="log-message">${log.message}</div>` : ''}
                        
                        ${log.error ? `<div class="log-message" style="background: #fdf2f2; color: #e74c3c;">é”™è¯¯: ${log.error}</div>` : ''}
                        
                        ${log.sqls && log.sqls.length > 0 ? `
                            <div class="sql-list" style="margin-top: 10px; padding: 12px; background: #fef7f7; border-radius: 6px; border: 1px solid #fadbd8;">
                                <div style="font-weight: 600; margin-bottom: 10px; color: #e74c3c; font-size: 14px;">ğŸ—„ï¸ SQLæ“ä½œ (${log.sqls.length})</div>
                                ${log.sqls.map((sql, index) => `
                                    <div class="sql-item" style="margin-bottom: 12px; padding: 10px; background: #2c3e50; border-radius: 4px; border: 1px solid #e74c3c; color: #ecf0f1;">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #ecf0f1; font-size: 12px;">SQL #${index + 1}:</div>
                                        <div style="margin-bottom: 8px; font-family: 'Courier New', monospace; font-size: 12px; background: #34495e; padding: 8px; border-radius: 3px; border-left: 3px solid #e74c3c; line-height: 1.4; color: #ecf0f1;">
                                            ${sql.sql || 'N/A'}
                                        </div>
                                        <div style="display: flex; gap: 20px; font-size: 11px; color: #bdc3c7;">
                                            <span>â±ï¸ è€—æ—¶: ${(sql.cost_seconds || 0).toFixed(3)}s</span>
                                            <span>ğŸ“Š å½±å“è¡Œæ•°: ${sql.rows_affected || 0}</span>
                                            <span>ğŸ“ ä½ç½®: ${sql.stack || 'N/A'}</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            container.innerHTML = logsHtml;
        }

        // æ–°å¢å‡½æ•°ï¼šæ¸²æŸ“Redisæ—¥å¿—ï¼ˆåªæ˜¾ç¤ºRedisç›¸å…³å†…å®¹ï¼‰
        function renderRedisLogs(logs) {
            const container = document.getElementById('redis-logs-list');
            
            if (logs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ğŸ”´</div>
                        <div>æš‚æ— Redisæ“ä½œæ—¥å¿—</div>
                        <div style="font-size: 12px; margin-top: 10px;">è¯·ç¨åå†è¯•æˆ–åˆ‡æ¢åˆ°å…¶ä»–æ ‡ç­¾é¡µ</div>
                    </div>
                `;
                return;
            }

            let logsHtml = '';
            logs.forEach(log => {
                const statusClass = log.success ? 'status-success' : 'status-error';
                const statusText = log.success ? 'æˆåŠŸ' : 'å¤±è´¥';
                
                logsHtml += `
                    <div class="log-entry ${log.type}">
                        <div class="log-header">
                            <div>
                                <span class="log-type ${log.type}">${getLogTypeText(log.type)}</span>
                                <span class="status-indicator ${statusClass}"></span>
                                <span style="font-size: 12px; color: #7f8c8d;">${statusText}</span>
                            </div>
                            <div class="log-timestamp">${log.timestamp}</div>
                        </div>
                        
                        <div class="log-details">
                            ${log.traceId ? `<div class="log-detail-item">
                                <span class="log-detail-label">Trace ID:</span>
                                <span class="log-detail-value">${log.traceId}</span>
                            </div>` : ''}
                            ${log.method ? `<div class="log-detail-item">
                                <span class="log-detail-label">æ–¹æ³•:</span>
                                <span class="log-detail-value">${log.method}</span>
                            </div>` : ''}
                            ${log.path ? `<div class="log-detail-item">
                                <span class="log-detail-label">è·¯å¾„:</span>
                                <span class="log-detail-value">${log.path}</span>
                            </div>` : ''}
                            ${log.duration ? `<div class="log-detail-item">
                                <span class="log-detail-label">æ€»è€—æ—¶:</span>
                                <span class="log-detail-value">${log.duration.toFixed(3)}s</span>
                            </div>` : ''}
                        </div>
                        
                        ${log.message ? `<div class="log-message">${log.message}</div>` : ''}
                        
                        ${log.error ? `<div class="log-message" style="background: #fdf2f2; color: #e74c3c;">é”™è¯¯: ${log.error}</div>` : ''}
                        
                        ${log.redisOps && log.redisOps.length > 0 ? `
                            <div class="redis-list" style="margin-top: 10px; padding: 12px; background: #fef9e7; border-radius: 6px; border: 1px solid #f8d7da;">
                                <div style="font-weight: 600; margin-bottom: 10px; color: #f39c12; font-size: 14px;">ğŸ”´ Redisæ“ä½œ (${log.redisOps.length})</div>
                                ${log.redisOps.map((redis, index) => `
                                    <div class="redis-item" style="margin-bottom: 12px; padding: 10px; background: #2c3e50; border-radius: 4px; border: 1px solid #f39c12; color: #ecf0f1;">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #ecf0f1; font-size: 12px;">Redis #${index + 1}:</div>
                                        <div style="margin-bottom: 8px; font-family: 'Courier New', monospace; font-size: 12px; background: #34495e; padding: 8px; border-radius: 3px; border-left: 3px solid #f39c12; line-height: 1.4; color: #ecf0f1;">
                                            ${redis.handle || 'N/A'}
                                        </div>
                                        <div style="display: flex; gap: 20px; font-size: 11px; color: #bdc3c7;">
                                            <span>â±ï¸ è€—æ—¶: ${(redis.cost_seconds || 0).toFixed(3)}s</span>
                                            <span>ğŸ”‘ Key: ${redis.key || 'N/A'}</span>
                                            ${redis.value ? `<span>ğŸ’¾ Value: ${redis.value}</span>` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            container.innerHTML = logsHtml;
        }
    </script>
</body>
</html>
